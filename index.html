<script>
  const canvas = document.getElementById('starCanvas');
  const ctx = canvas.getContext('2d');

  function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  window.addEventListener('resize', resizeCanvas);
  resizeCanvas();

  // 生成星星
  const stars = [];
  const STAR_COUNT = 90;  // 星星数量，可调大/调小

  function createStar() {
    return {
      x: Math.random() * canvas.width,
      y: Math.random() * canvas.height,
      radius: Math.random() * 2.2 + 1.0,       // 控制星星大小
      speedY: Math.random() * 1.5 + 0.5,       // 下落速度
      speedX: (Math.random() - 0.5) * 0.3,     // 略微斜着飘
      alpha: Math.random() * 0.5 + 0.5         // 透明度
    };
  }

  for (let i = 0; i < STAR_COUNT; i++) {
    stars.push(createStar());
  }

  function updateStars() {
    for (let s of stars) {
      s.y += s.speedY;
      s.x += s.speedX;

      // 超出底部后重新从上面生成
      if (s.y > canvas.height + 10) {
        s.x = Math.random() * canvas.width;
        s.y = -10;
        s.speedY = Math.random() * 1.5 + 0.5;
        s.speedX = (Math.random() - 0.5) * 0.3;
        s.radius = Math.random() * 2.2 + 1.0;
        s.alpha = Math.random() * 0.5 + 0.5;
      }
    }
  }

  // ⭐ 画五角星函数
  function drawStarShape(ctx, x, y, outerRadius, alpha) {
    const spikes = 5;
    const innerRadius = outerRadius * 0.45;
    let rot = -Math.PI / 2;     // 从正上方开始
    let step = Math.PI / spikes;

    ctx.save();
    ctx.translate(x, y);
    ctx.beginPath();
    ctx.moveTo(
      Math.cos(rot) * outerRadius,
      Math.sin(rot) * outerRadius
    );

    for (let i = 0; i < spikes; i++) {
      rot += step;
      ctx.lineTo(
        Math.cos(rot) * innerRadius,
        Math.sin(rot) * innerRadius
      );
      rot += step;
      ctx.lineTo(
        Math.cos(rot) * outerRadius,
        Math.sin(rot) * outerRadius
      );
    }

    ctx.closePath();
    ctx.fillStyle = 'rgba(150, 150, 150,' + alpha + ')';
    ctx.fill();
    ctx.restore();
  }

  function drawStars() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    for (let s of stars) {
      // 用五角星代替小圆点
      drawStarShape(ctx, s.x, s.y, s.radius, s.alpha);
    }
  }

  function animate() {
    updateStars();
    drawStars();
    requestAnimationFrame(animate);
  }

  animate();
</script>
